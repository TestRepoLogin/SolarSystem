@model IEnumerable<SolarSystemWeb.Models.Entities.SpaceObjectDto>

@{
    ViewBag.Title = "title";
    Layout = "../Shared/AdminLayout.cshtml";
}

<style>
    .table-nonfluid {
       width: 70% !important;
       border: grey 1px solid !important;
    }
    .table td {
        padding: 10px !important;
    }
    .table th {
        padding: 15px !important;
    }
</style>

<script>

    function showModal(title, text, onOkCallback) {
        $('.modal .modal-title').text(title);
        $('.modal .modal-body').text(text);
        
        $('.modal .ok').off('click');
        $('.modal .ok').on('click', onOkCallback);

        $('.modal').modal('show');
    }

    function hideModal() {
        $('.modal').modal('hide');
    }

    function showAlert(parentSelector, text) {
        var alert = '<div class="alert alert-dismissible alert-danger">' + 
                        '<button type="button" class="close" data-dismiss="alert">×</button>' +                        
                        text + 
                    '</div>';
        $(parentSelector).append(alert);
    }


    function deleteObject(id, trId) {
        $.ajax({
            url: '/Admin/DeleteObject',
            data: { id: id },
            type: 'get',   
            dataType: 'json', 
            success: function() {                
                $('#' + trId).remove();
            },
            error: function(data) {
                showAlert('#messages', 'При выполнении запроса произошла ошибка. Поробуйте выполнить операцию позже');
            },
            complete: function() {                
                hideModal();
            }
        });
    }

    function onDelete(id, trId) {
        showModal('Внимание!', 'Вы действительно хотите удалить запись?', 
            function() {
                deleteObject(id, trId);        
            });        
    }

    function onEdit(id) {
        
    }
</script>

<div id="messages"  style="width: 40%;"></div>

<table class="table table-striped table-hover table-nonfluid">
    <thead>
    <tr class="info">
        <th>Название</th>
        <th>Тип</th>
        <th>Масса</th>
        <th>Радиус</th>
        <th>Радиус орбиты</th>
        <th>Владелец</th>
        <th>Редактировать</th>
        <th>Удалить</th>
    </tr>
    </thead>
    <tbody>
    @{
        foreach (var item in Model)
        {
            <tr id="tr_@item.Id">
                <td>@item.Name</td>
                <td>@item.TypeName</td>
                <td>@item.Mass</td>
                <td>@item.Radius</td>
                <td>@item.Distance</td>
                <td>@item.OwnerName</td>
                <td><a onclick="onEdit(@item.Id);return false;" href="javascript:void(0);">Редактировать</a></td>
                <td><a onclick="onDelete(@item.Id, 'tr_@item.Id');return false;" href="javascript:void(0);">Удалить</a></td>
            </tr>
        }
    }
    </tbody>
</table>

<div class="modal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title"></h4>
            </div>
            <div class="modal-body">
                
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default cancel" data-dismiss="modal">Отмена</button>
                <button type="button" class="btn btn-primary ok">Ок</button>
            </div>
        </div>
    </div>
</div>